# **유니온 파인드 (Union-Find)**
![union-find](https://i.ytimg.com/vi/0jNmHPfA_yE/maxresdefault.jpg)
## **Disjoint-Set ?**
- **서로 중복되지 않는 부분 집합**들로 나눠진 원소들에 대한 정보를 관리하는 자료구조
- 즉, 공통 원소가 없는 상호 배타적 집합들로 이루어진 자료구조이다.
## **정의**
- Disjoint-Set을 표현할 때 사용하는 알고리즘
- 집합을 구현하는데는 비트 벡터, 배열, 연결 리스트 등을 이용할 수 있으나 그 중 가장 효율적인 트리구조를 이용하여 구현
## **연산**
- make-set(x)
    - 초기화
    - x를 유일한 원소로 하는 새로운 집합을 만든다.
- union(x, y)
    - 합치기
    - x가 속한 집합과 y가 속한 두 집합을 합친다.
- find(x)
    - 부모 찾기
    - x가 속한 집합의 부모(루트 노드)를 찾는다. 즉, x가 어떤 집합에 속해 있는지 찾는다.
## **트리 구조를 이용하여 구현하는 이유** 
- 배열
    - arr[i]: i번 원소가 속하는 집합의 번호(즉, 루트 노드의 번호)
    - make-set(x)
        - arr[i] = i
    - union(x, y)
        - 배열의 모든 원소를 순회하며 y의 집합 번호를 x로 바꾼다.
        - O(N)
    - find(x)
        - 한 번만에 x가 속한 집합을 찾는다.
        - O(1)
- 트리
    - 같은 집합 = 하나의 트리, 즉 집합 번호 = 루트 노드
    - make-set(x)
        - 각 노드는 모두 루트 노드이므로 N개의 루트 노드 생성 및 자기 자신으로 초기화
    - union(x, y)
        - x, y의 루트 노드를 찾고 다르면 y를 x의 집합에 포함하여 두 트리를 합친다.
        - O(N)보다 작으므로 find 연산이 거의 전체 수행 시간을 차지한다.
    - find(X)
        - 노드의 집합 번호는 루트 노드이므로, 루트 노드를 확인하여 같은 집합인지 확인한다.
        - 트리의 높이와 시간 복잡도 동일, 최악은 집합이 한 개 존재하는 O(N-1)
## **분할**
- 전체 집합이 구성 원소들이 겹치지 않도록 하는데 자주 사용
- Kruskal MST 알고리즘에서 새로 추가할 간선의 양끝 정점이 같은 집합에 속해 있는지(사이클 형성 여부)에 대해 검사
- 임의의 집합을 분할한다는 것은 각 부분 집합이 아래의 두 가지 조건을 만족하는 Disjoint-Set이 되도록 쪼개는 것이다.
    1. 분할된 부분 집합을 합치면 원래의 전체 집합이 된다.
    2. 분할된 부분 집합 간에는 겹치는 원소가 없다.
## **최적화**
- 최악의 경우
    - 트리 구조가 완전 비대칭인 경우
    - 연결 리스트 형태
    - 트리의 높이 최대
    - 원소의 개수가 N일 때 트리의 높이가 N-1 이므로 union과 find의 시간 복잡도가 모두 O(N)이 된다.
    - 배열로 구현하는 것보다 비효율적
- 최적화
    - find
        - 경로압축: find 하면서 만난 모든 정점의 부모 노드를 루트 노드로 만든다
        - 경로 압축을 한 find의 시간 복잡도는 O(a(N))이 되는데 여기서 a(N)은 아커만 함수를 의미한다.
        - 아커만 함수에서 N이 2^65536일 때, 아커만 함수의 값은 5가 되므로 상수의 시간 복잡도를 가진다고 봐도 무방하다.
    - union
        - union-by-rank(height)
        - 항상 높이가 더 낮은 트리를 높은 트리 밑에 넣는다.


### **참고**
- https://gmlwjd9405.github.io/2018/08/31/algorithm-union-find.html
- https://dheldh77.tistory.com/entry/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98-%EC%9C%A0%EB%8B%88%EC%98%A8%ED%8C%8C%EC%9D%B8%EB%93%9CUnion-Find-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98-1